<!DOCTYPE html>
<html>
<head>
    <title>Stock Analysis</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Top 10 Stocks by Relative Volume</h1>
    <form method="GET" action="/">
        <label for="price_min">Min Price:</label>
        <input type="number" name="price_min" step="0.01">
        <label for="price_max">Max Price:</label>
        <input type="number" name="price_max" step="0.01">
        <input type="submit" value="Filter">
    </form>
    <table>
        <tr>
            <th>Symbol</th>
            <th>Relative Volume</th>
            <th>Price</th>
        </tr>
        {% for stock in stocks %}
        <tr>
            <td><a href="/news/{{ stock.symbol }}">{{ stock.symbol }}</a></td>
            <td>{{ stock.relative_volume }}</td>
            <td>{{ stock.price }}</td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>

<script>
    function fetchData() {
        fetch('/update')
            .then(response => response.json())
            .then(data => {
                // Update the table with new data
                let table = document.querySelector('table');
                table.innerHTML = `
                    <tr>
                        <th>Symbol</th>
                        <th>Relative Volume</th>
                        <th>Price</th>
                    </tr>
                `;
                data.forEach(stock => {
                    let row = table.insertRow();
                    row.insertCell(0).innerHTML = `<a href="/news/${stock.symbol}">${stock.symbol}</a>`;
                    row.insertCell(1).innerHTML = stock.relative_volume;
                    row.insertCell(2).innerHTML = stock.price;
                });
            });
    }
    
    // Fetch data every 5 minutes
    setInterval(fetchData, 300000);
    fetchData();  // Initial fetch
    </script>
    